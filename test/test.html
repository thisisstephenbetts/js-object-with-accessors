<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="qunit-1.13.0.css">
	<script src='qunit-1.13.0.js'></script>
	<script src='../src/class.js'></script>
	<script src='../src/object_with_accessors.js'></script>
	<!-- <script src='http://influxenterprises.pathinonnu.local/j/lib/object_with_accessors.js'></script>
		<script src='http://influxenterprises.pathinonnu.local/j/vdr/jquery-1.7.1.min.js'></script> -->
	<script>
		ObjectWithAccessors.createSubclass('SubClass',{
			init: function(args) { this._super(args) },
			'_accessors': ['first','second','third']
		});
		// Overriding defined method
		SubClass.prototype.another = function() {
			return 'another method in class '+this.constructor.name
		}
		
		SubClass.createSubclass('SubSubClass',{
			init: function(args) { this._super(args) },
			'_accessors': ['fourth']
		});
		  	
		// Overriding defined method
		SubSubClass.prototype.second = function() {
			return 'Overridden "second" method'
		}
		
		//Defining new method
		SubSubClass.prototype.extra_method = function() {
			return 'New method SubSubClass#extra_method'
		}
		
		var a = new SubClass;
		a.first('a 1st');
		a.second('a 2nd');

		var a2 = new SubClass({first: 'A', second: 'B', third: 'C'});

		var b = new SubSubClass;
		b.first('b 1st');
		b.second('b 2nd');
		b.third('b 3rd');
		b.fourth('b 4th');
		b.extra_method('b extra');
		
		var b2 = new SubSubClass({first: 'b2 first', second: 'b2 second', third: 'b2 third', fourth: 'b2 fourth'});;
		
		
		test('a, instance of SubClass',function() {
			equal(a.first(),'a 1st');
			equal(a.second(),'a 2nd');
			equal(a.third(),undefined);
			throws(function() { a.fourth() },"TypeError: Object #<SubClass> has no method 'fourth'");
			equal(a.another(),'another method in class SubClass');
		})
		
		test('a2, another instance of SubClass',function() {
			equal(a2.first(),'A');
			equal(a2.second(),'B');
			equal(a2.third(),'C');
			throws(function() { a2.fourth() },"TypeError: Object #<SubClass> has no method 'fourth'");
			equal(a2.another(),'another method in class SubClass');
		});
		
		test('b, instance of SubSubClass',function() {
			equal(b.first(),'b 1st');
			equal(b.second(),'Overridden "second" method');
			equal(b.third(),'b 3rd');
			equal(b.fourth(),'b 4th');
			equal(b.another(),'another method in class SubSubClass');
			equal(b.extra_method(),'New method SubSubClass#extra_method');
		});

		test('b2, another instance of SubSubClass',function() {
			equal(b2.first(),'b2 first');
			equal(b2.second(),'Overridden "second" method');
			equal(b2.third(),'b2 third');
			equal(b2.fourth(),'b2 fourth');
			equal(b2.another(),'another method in class SubSubClass');
			equal(b2.extra_method(),'New method SubSubClass#extra_method');
		});
		
		test("a instanceof SubClass",function() {
			ok(a instanceof SubClass);
		});


		test("a not instanceof SubSubClass",function() {
			ok(!(a instanceof SubSubClass));
		});

		test("b instanceof SubClass",function() {
			ok(b instanceof SubClass);
		});


		test("b instanceof SubSubClass",function() {
			ok(b instanceof SubSubClass);
		});
		
	</script>
</head>
<body>
	<div id="qunit"></div>
</body>	
</html>
